<!DOCTYPE html>
<html>
    <head>
        <title>Refuge | Data should be yours ! - GeoCouch and Refuge</title>
        <meta name="description" content="description">
        <meta name="keywords" content="keywords">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="viewport" content="user-scalable=no; width=device-width; initial-scale=1.0; maximum-scale=1.0;">
        <link href="http://fonts.googleapis.com/css?family=Lato:400,700,900,400italic,700italic,900italic" rel="stylesheet" type="text/css">
        <link rel="stylesheet" type="text/css" href="/css/style.css">
        
    </head>
    <body>
        <div class="container">
            <header class="header">
                <a href="/" class="a-backtohome"></a>
                <nav>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/details/">Refuge</a></li>
                        <li><a href="/devices/">Devices</a>
                            <!--<ul class="ss-menu">
                                <li><a href="#">The Refuge Box</a></li>
                                <li><a href="#">Refuge for Android</a></li>
                                <li><a href="#">Refuge for iOS</a></li>
                            </ul>-->
                        </li>
                        <li><a href="/download/">Download</a></li>
                        <li><a href="/project/">Project</a></li>
                        <li><a href="/news">News</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="/shop/">Shop</a></li>
                    </ul>
                </nav>
            </header>

    <section class="post">
        <article>
            <div class="whole">
                <div class="wrap">
                    <h1>GeoCouch and Refuge</h1>
                    <time class="date" datetime="2012-03-25T00:00:00+01:00">25 March 2012</time>
                </div>
                <div class="content">
                    <p>Hello,</p>

<p>Two news about <strong>geocouch</strong> in <a href='http://refuge.io/'>Refuge</a>:</p>

<ul>
<li>geocouch has been renamed as <a href='https://github.com/refuge/refuge_spatial'>refuge_spatial</a>, and becomes officially a fork of geocouch (if it wasn&#8217;t already the case ;-) ). The previous geocouch is still available in a different <a href='https://github.com/refuge/geocouch'>repository</a>.</li>

<li>knn query (knn stands for k-nearest-neighbour) ability into refuge_spatial.</li>
</ul>

<p>knn query gives you the ability to request the n nearest geometries relative to a given query point, with the following parameters:</p>

<ul>
<li><code>n</code>: number of geometries being returned</li>

<li><code>q</code>: the geometry used as reference point</li>

<li><code>spherical=true</code>: the <a href='http://en.wikipedia.org/wiki/Haversine_formula'>Haversine formula</a> is used to calculate spherical distances for nearest-neighbour-queries. In this case the geometries are expected to use the coordinate system <a href='http://en.wikipedia.org/wiki/WGS_84'>WGS 84</a>.</li>
</ul>

<p>Example: returning 2 nearest geometries to the point <code>(50,10)</code> and using spherical distance computation:</p>

<pre><code>curl -X GET &#39;http://localhost:5984/places/_design/main/_spatial/points?n=2&amp;q=50,10&amp;spherical=true&#39;</code></pre>

<p>This integration has been adapted from the excellent work done by Tobias Sauerwein (Twitter: <a href='https://twitter.com/#!/tsauerwein'>@tsauerwein</a>) in the branch <a href='https://github.com/tsauerwein/geocouch/tree/knn_1.2.x'>knn_1.2.x</a>.</p>

<p><strong>Have fun!</strong></p>

<p>Thank you,</p>

<p>Nicolas Dufour <a href='mailto:nicolas.dufour@nemoworld.info'>&#110;&#105;&#099;&#111;&#108;&#097;&#115;&#046;&#100;&#117;&#102;&#111;&#117;&#114;&#064;&#110;&#101;&#109;&#111;&#119;&#111;&#114;&#108;&#100;&#046;&#105;&#110;&#102;&#111;</a> (CapNemo)</p>
                </div>
            </div>
        </article>
    </section>

            <footer>
                <div class="wrap-footer">
                    <div class="one-third">
                        <article>
                            <h2><div></div><span>Mailing</span> list</h2>
                            <form class="mailing-list">
                                <input type="text" />
                                <input type="submit" value="Send" />
                            </form>
                            <p>Sign up to get latest news about <a href="#">Refuge Project</a> and more...</p>
                        </article>
                    </div>
                    <div class="one-third">
                        <article>
                            <h2><div></div>More <span>info</span></h2>
                            <ul>
                                <li><a href="/refuge-intro.html">Refuge</a></li>
                                <li><a href="/devices.html">Devices</a></li>
                                <li><a href="/download.html">Download</a></li>
                                <li><a href="/project.html">Project</a></li>
                                <li><a href="/community.html">Community</a></li>
                                <li><a href="/shop.html">Shop</a></li>
                            </ul>
                        </article>
                    </div>
                    <div class="one-third last">
                        <article>
                            <h2><div></div><span>Community</span> box</h2>
                            <ul>
                                <li><a href="#" class="link-twitter-account"><span></span>Twitter</a></li>
                                <li><a href="#" class="link-gplus-account"><span></span>Google +</a></li>
                                <li><a href="#" class="link-irc-account"><span></span>IRC</a></li>
                            </ul>
                        </article>
                    </div>
                    <div class="clear"></div>
                    <span class="copyrights">2013 Â© Refuge. Designed by <a href="http://www.lolograph.com" target="_blank">lolograph</a></span>
                </div>
            </footer>

        </div>
    </body>
</html>
