<!DOCTYPE html>
<html>
    <head>
        <title>Refuge | Data should be yours ! - View changes since...</title>
        <meta name="description" content="description">
        <meta name="keywords" content="keywords">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="viewport" content="user-scalable=no; width=device-width; initial-scale=1.0; maximum-scale=1.0;">
        <link href="http://fonts.googleapis.com/css?family=Lato:400,700,900,400italic,700italic,900italic" rel="stylesheet" type="text/css">
        <link rel="stylesheet" type="text/css" href="/css/style.css">
        
    </head>
    <body>
        <div class="container">
            <header class="header">
                <a href="/" class="a-backtohome"></a>
                <nav>
                    <ul>
                        <li><a href="/">Home</a></li>
                        <li><a href="/details/">Refuge</a></li>
                        <li><a href="/devices/">Devices</a>
                            <!--<ul class="ss-menu">
                                <li><a href="#">The Refuge Box</a></li>
                                <li><a href="#">Refuge for Android</a></li>
                                <li><a href="#">Refuge for iOS</a></li>
                            </ul>-->
                        </li>
                        <li><a href="/download/">Download</a></li>
                        <li><a href="/project/">Project</a></li>
                        <li><a href="/news">News</a></li>
                        <li><a href="/community/">Community</a></li>
                        <li><a href="/shop/">Shop</a></li>
                    </ul>
                </nav>
            </header>

    <section class="post">
        <article>
            <div class="whole">
                <div class="wrap">
                    <h1>View changes since...</h1>
                    <time class="date" datetime="2012-02-23T00:00:00+01:00">23 February 2012</time>
                </div>
                <div class="content">
                    <p>Quite happy,</p>

<p>After a couple of days to figure how the code of the map/reduce engine was organized. Another days passed to think how adding a btree by sequence to a view group with the help of <a href='https://github.com/davisp'>@davisp</a>, I finally have a working patch. It&#8217;s now possible to <strong>get all changes in a view since</strong>&#8230; Tommorrow , I will plug it to the <code>_changes</code> feed.</p>

<p>Code is available in <a href='https://github.com/refuge/couch_mrview/tree/btree_byseq'>refuge</a>.</p>

<p>Here is a quick example on how to use it:</p>

<pre><code>(refuge@127.0.0.1)3&gt; F = fun(KV, Acc) -&gt; {ok, [KV|Acc]} end. 
#Fun&lt;erl_eval.12.111823515&gt;
(refuge@127.0.0.1)4&gt; 
(refuge@127.0.0.1)4&gt; couch_mrview:view_changes_since(Db, DDoc, &lt;&lt;&quot;all&quot;&gt;&gt;, 9990, F).   
[info] [&lt;0.220.0&gt;] Opening index for db: testdb idx: _design/test sig: &quot;85b8fa1e39dc7fbe8b11b729b319c6bf&quot;
{ok,[{10000,{&lt;&lt;&quot;72f9250618e65adc8cf4552758fff137&quot;&gt;&gt;,0}},
     {9999,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffe85d&quot;&gt;&gt;,0}},
     {9998,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffdbcf&quot;&gt;&gt;,0}},
     {9997,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffd65e&quot;&gt;&gt;,0}},
     {9996,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffd611&quot;&gt;&gt;,0}},
     {9995,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffd045&quot;&gt;&gt;,0}},
     {9994,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffc982&quot;&gt;&gt;,0}},
     {9993,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffbfdb&quot;&gt;&gt;,0}},
     {9992,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffb1fc&quot;&gt;&gt;,0}},
     {9991,{&lt;&lt;&quot;72f9250618e65adc8cf4552758ffae18&quot;&gt;&gt;,0}}]}
(refuge@127.0.0.1)5&gt;   
(refuge@127.0.0.1)5&gt; couch_mrview:view_changes_since(Db, DDoc, &lt;&lt;&quot;all&quot;&gt;&gt;, 10000, F).    
{ok,[]}
(refuge@127.0.0.1)7&gt; couch_mrview:view_changes_since(Db, DDoc, &lt;&lt;&quot;all&quot;&gt;&gt;, 10000, F).   
{ok,[{10002,{&lt;&lt;&quot;31b0c9f8353b6b3e2a86c23d2c000a78&quot;&gt;&gt;,0}}]}</code></pre>

<p>enjoy.</p>

<ul>
<li>benoît</li>
</ul>
                </div>
            </div>
        </article>
    </section>

            <footer>
                <div class="wrap-footer">
                    <div class="one-third">
                        <article>
                            <h2><div></div><span>Mailing</span> list</h2>
                            <form class="mailing-list">
                                <input type="text" />
                                <input type="submit" value="Send" />
                            </form>
                            <p>Sign up to get latest news about <a href="#">Refuge Project</a> and more...</p>
                        </article>
                    </div>
                    <div class="one-third">
                        <article>
                            <h2><div></div>More <span>info</span></h2>
                            <ul>
                                <li><a href="/refuge-intro.html">Refuge</a></li>
                                <li><a href="/devices.html">Devices</a></li>
                                <li><a href="/download.html">Download</a></li>
                                <li><a href="/project.html">Project</a></li>
                                <li><a href="/community.html">Community</a></li>
                                <li><a href="/shop.html">Shop</a></li>
                            </ul>
                        </article>
                    </div>
                    <div class="one-third last">
                        <article>
                            <h2><div></div><span>Community</span> box</h2>
                            <ul>
                                <li><a href="#" class="link-twitter-account"><span></span>Twitter</a></li>
                                <li><a href="#" class="link-gplus-account"><span></span>Google +</a></li>
                                <li><a href="#" class="link-irc-account"><span></span>IRC</a></li>
                            </ul>
                        </article>
                    </div>
                    <div class="clear"></div>
                    <span class="copyrights">2013 © Refuge. Designed by <a href="http://www.lolograph.com" target="_blank">lolograph</a></span>
                </div>
            </footer>

        </div>
    </body>
</html>
